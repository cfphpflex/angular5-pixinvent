!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs/Subject"),require("rxjs/observable/merge"),require("rxjs/operators/map"),require("rxjs/operators/mergeMap"),require("rxjs/operators/takeUntil"),require("rxjs/operators/take"),require("rxjs/operators/takeLast"),require("rxjs/operators/pairwise"),require("rxjs/operators/share"),require("rxjs/operators/filter"),require("rxjs/operators/distinctUntilChanged")):"function"==typeof define&&define.amd?define(["exports","@angular/core","rxjs/Subject","rxjs/observable/merge","rxjs/operators/map","rxjs/operators/mergeMap","rxjs/operators/takeUntil","rxjs/operators/take","rxjs/operators/takeLast","rxjs/operators/pairwise","rxjs/operators/share","rxjs/operators/filter","rxjs/operators/distinctUntilChanged"],t):t(e["angular-draggable-droppable"]={},e.ng.core,e.Rx,e.Rx.Observable,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype)}(this,function(e,t,n,r,i,o,s,u,a,p,c,l,d){"use strict";var v=function(){return function(){this.currentDrag=new n.Subject}}(),g="move",h=function(){function e(e,r,i,o){this.element=e,this.renderer=r,this.draggableHelper=i,this.zone=o,this.dragAxis={x:!0,y:!0},this.dragSnapGrid={},this.ghostDragEnabled=!0,this.dragCursor=g,this.dragPointerDown=new t.EventEmitter,this.dragStart=new t.EventEmitter,this.dragging=new t.EventEmitter,this.dragEnd=new t.EventEmitter,this.pointerDown=new n.Subject,this.pointerMove=new n.Subject,this.pointerUp=new n.Subject,this.eventListenerSubscriptions={}}return e.prototype.ngOnInit=function(){var e=this;this.checkEventListeners();var t=this.pointerDown.pipe(l.filter(function(){return e.canDrag()})).pipe(o.mergeMap(function(t){var o=new n.Subject;e.zone.run(function(){e.dragPointerDown.next({x:0,y:0})});var p=e.pointerMove.pipe(i.map(function(e){return e.event.preventDefault(),{currentDrag:o,x:e.clientX-t.clientX,y:e.clientY-t.clientY,clientX:e.clientX,clientY:e.clientY}})).pipe(i.map(function(t){return e.dragSnapGrid.x&&(t.x=Math.floor(t.x/e.dragSnapGrid.x)*e.dragSnapGrid.x),e.dragSnapGrid.y&&(t.y=Math.floor(t.y/e.dragSnapGrid.y)*e.dragSnapGrid.y),t})).pipe(i.map(function(t){return e.dragAxis.x||(t.x=0),e.dragAxis.y||(t.y=0),t})).pipe(l.filter(function(t){var n=t.x,r=t.y;return!e.validateDrag||e.validateDrag({x:n,y:r})})).pipe(s.takeUntil(r.merge(e.pointerUp,e.pointerDown))).pipe(c.share());return p.pipe(u.take(1)).subscribe(function(){t.event.preventDefault(),e.zone.run(function(){e.dragStart.next({x:0,y:0})}),e.setCursor(e.dragCursor),e.draggableHelper.currentDrag.next(o)}),p.pipe(a.takeLast(1)).subscribe(function(t){var n=t.x,r=t.y;e.zone.run(function(){e.dragEnd.next({x:n,y:r})}),o.complete(),e.setCssTransform(null),e.ghostDragEnabled&&e.renderer.setStyle(e.element.nativeElement,"pointerEvents",null)}),p})).pipe(c.share());r.merge(t.pipe(u.take(1)).pipe(i.map(function(e){return[,e]})),t.pipe(p.pairwise())).pipe(l.filter(function(e){var t=e[0],n=e[1];return!t||(t.x!==n.x||t.y!==n.y)})).pipe(i.map(function(e){e[0];return e[1]})).subscribe(function(t){var n=t.x,r=t.y,i=t.currentDrag,o=t.clientX,s=t.clientY;e.zone.run(function(){e.dragging.next({x:n,y:r})}),e.ghostDragEnabled&&e.renderer.setStyle(e.element.nativeElement,"pointerEvents","none"),e.setCssTransform("translate("+n+"px, "+r+"px)"),i.next({clientX:o,clientY:s,dropData:e.dropData})})},e.prototype.ngOnChanges=function(e){e.dragAxis&&this.checkEventListeners()},e.prototype.ngOnDestroy=function(){this.unsubscribeEventListeners(),this.pointerDown.complete(),this.pointerMove.complete(),this.pointerUp.complete()},e.prototype.checkEventListeners=function(){var e=this,t=this.canDrag(),n=Object.keys(this.eventListenerSubscriptions).length>0;t&&!n?this.zone.runOutsideAngular(function(){e.eventListenerSubscriptions.mousedown=e.renderer.listen(e.element.nativeElement,"mousedown",function(t){e.onMouseDown(t)}),e.eventListenerSubscriptions.mouseup=e.renderer.listen("document","mouseup",function(t){e.onMouseUp(t)}),e.eventListenerSubscriptions.touchstart=e.renderer.listen(e.element.nativeElement,"touchstart",function(t){e.onTouchStart(t)}),e.eventListenerSubscriptions.touchend=e.renderer.listen("document","touchend",function(t){e.onTouchEnd(t)}),e.eventListenerSubscriptions.touchcancel=e.renderer.listen("document","touchcancel",function(t){e.onTouchEnd(t)}),e.eventListenerSubscriptions.mouseenter=e.renderer.listen(e.element.nativeElement,"mouseenter",function(){e.onMouseEnter()}),e.eventListenerSubscriptions.mouseleave=e.renderer.listen(e.element.nativeElement,"mouseleave",function(){e.onMouseLeave()})}):!t&&n&&this.unsubscribeEventListeners()},e.prototype.onMouseDown=function(e){var t=this;this.eventListenerSubscriptions.mousemove||(this.eventListenerSubscriptions.mousemove=this.renderer.listen("document","mousemove",function(e){t.pointerMove.next({event:e,clientX:e.clientX,clientY:e.clientY})})),this.pointerDown.next({event:e,clientX:e.clientX,clientY:e.clientY})},e.prototype.onMouseUp=function(e){this.eventListenerSubscriptions.mousemove&&(this.eventListenerSubscriptions.mousemove(),delete this.eventListenerSubscriptions.mousemove),this.pointerUp.next({event:e,clientX:e.clientX,clientY:e.clientY})},e.prototype.onTouchStart=function(e){var t=this;this.eventListenerSubscriptions.touchmove||(this.eventListenerSubscriptions.touchmove=this.renderer.listen("document","touchmove",function(e){t.pointerMove.next({event:e,clientX:e.targetTouches[0].clientX,clientY:e.targetTouches[0].clientY})})),this.pointerDown.next({event:e,clientX:e.touches[0].clientX,clientY:e.touches[0].clientY})},e.prototype.onTouchEnd=function(e){this.eventListenerSubscriptions.touchmove&&(this.eventListenerSubscriptions.touchmove(),delete this.eventListenerSubscriptions.touchmove),this.pointerUp.next({event:e,clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY})},e.prototype.onMouseEnter=function(){this.setCursor(this.dragCursor)},e.prototype.onMouseLeave=function(){this.setCursor(null)},e.prototype.setCssTransform=function(e){var t=this;if(this.ghostDragEnabled){["transform","-webkit-transform","-ms-transform","-moz-transform","-o-transform"].forEach(function(n){t.renderer.setStyle(t.element.nativeElement,n,e)})}},e.prototype.canDrag=function(){return this.dragAxis.x||this.dragAxis.y},e.prototype.setCursor=function(e){this.renderer.setStyle(this.element.nativeElement,"cursor",e)},e.prototype.unsubscribeEventListeners=function(){var e=this;Object.keys(this.eventListenerSubscriptions).forEach(function(t){e.eventListenerSubscriptions[t](),delete e.eventListenerSubscriptions[t]})},e}();h.decorators=[{type:t.Directive,args:[{selector:"[mwlDraggable]"}]}],h.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2},{type:v},{type:t.NgZone}]},h.propDecorators={dropData:[{type:t.Input}],dragAxis:[{type:t.Input}],dragSnapGrid:[{type:t.Input}],ghostDragEnabled:[{type:t.Input}],validateDrag:[{type:t.Input}],dragCursor:[{type:t.Input}],dragPointerDown:[{type:t.Output}],dragStart:[{type:t.Output}],dragging:[{type:t.Output}],dragEnd:[{type:t.Output}]};var f=function(){function e(e,n,r){this.element=e,this.draggableHelper=n,this.zone=r,this.dragEnter=new t.EventEmitter,this.dragLeave=new t.EventEmitter,this.dragOver=new t.EventEmitter,this.drop=new t.EventEmitter}return e.prototype.ngOnInit=function(){var e=this;this.currentDragSubscription=this.draggableHelper.currentDrag.subscribe(function(t){var n,r,s=e.element.nativeElement.getBoundingClientRect(),u=t.pipe(i.map(function(e){var t=e.clientX,r=e.clientY,i=e.dropData;return n=i,u=r,(o=t)>=(a=s).left&&o<=a.right&&u>=a.top&&u<=a.bottom;var o,u,a})),a=u.pipe(d.distinctUntilChanged());a.pipe(l.filter(function(e){return e})).subscribe(function(){r=!0,e.zone.run(function(){e.dragEnter.next({dropData:n})})}),u.pipe(l.filter(function(e){return e})).subscribe(function(){e.zone.run(function(){e.dragOver.next({dropData:n})})}),a.pipe(p.pairwise()).pipe(l.filter(function(e){var t=e[0],n=e[1];return t&&!n})).subscribe(function(){r=!1,e.zone.run(function(){e.dragLeave.next({dropData:n})})}),t.pipe(o.mergeMap(function(){return u})).subscribe({complete:function(){r&&e.zone.run(function(){e.drop.next({dropData:n})})}})})},e.prototype.ngOnDestroy=function(){this.currentDragSubscription.unsubscribe()},e}();f.decorators=[{type:t.Directive,args:[{selector:"[mwlDroppable]"}]}],f.ctorParameters=function(){return[{type:t.ElementRef},{type:v},{type:t.NgZone}]},f.propDecorators={dragEnter:[{type:t.Output}],dragLeave:[{type:t.Output}],dragOver:[{type:t.Output}],drop:[{type:t.Output}]};var m=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[v]}},e}();m.decorators=[{type:t.NgModule,args:[{declarations:[h,f],exports:[h,f]}]}],m.ctorParameters=function(){return[]},e.DragAndDropModule=m,e.DraggableHelper=v,e.ɵa=h,e.ɵb=f,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angular-draggable-droppable.umd.min.js.map
