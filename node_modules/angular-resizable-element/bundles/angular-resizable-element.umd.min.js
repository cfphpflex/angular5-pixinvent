!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs/Subject"),require("rxjs/Observable"),require("rxjs/observable/merge"),require("rxjs/observable/interval"),require("rxjs/operators/map"),require("rxjs/operators/mergeMap"),require("rxjs/operators/takeUntil"),require("rxjs/operators/filter"),require("rxjs/operators/pairwise"),require("rxjs/operators/take"),require("rxjs/operators/throttle"),require("rxjs/operators/share")):"function"==typeof define&&define.amd?define(["exports","@angular/core","rxjs/Subject","rxjs/Observable","rxjs/observable/merge","rxjs/observable/interval","rxjs/operators/map","rxjs/operators/mergeMap","rxjs/operators/takeUntil","rxjs/operators/filter","rxjs/operators/pairwise","rxjs/operators/take","rxjs/operators/throttle","rxjs/operators/share"],t):t(e["angular-resizable-element"]={},e.ng.core,e.Rx,e.Rx,e.Rx.Observable,e.Rx.Observable,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype)}(this,function(e,t,n,r,i,o,s,l,c,u,a,p,d,h){"use strict";function m(e,t,n){void 0===n&&(n=3);return Math.abs(e-t)<n}function v(e,t,n,r){var i={top:e.top,bottom:e.bottom,left:e.left,right:e.right};return t.top&&(i.top+=r),t.bottom&&(i.bottom+=r),t.left&&(i.left+=n),t.right&&(i.right+=n),i.height=i.bottom-i.top,i.width=i.right-i.left,i}function f(e){var t=e.clientY,n=e.rect;return t>=n.top&&t<=n.bottom}function g(e){var t=e.clientX,n=e.rect;return t>=n.left&&t<=n.right}function b(e){var t=e.clientX,n=e.clientY,r=e.elm,i=e.allowedEdges,o=e.cursorPrecision,s=r.nativeElement.getBoundingClientRect(),l={};return i.left&&m(t,s.left,o)&&f({clientY:n,rect:s})&&(l.left=!0),i.right&&m(t,s.right,o)&&f({clientY:n,rect:s})&&(l.right=!0),i.top&&m(n,s.top,o)&&g({clientX:t,rect:s})&&(l.top=!0),i.bottom&&m(n,s.bottom,o)&&g({clientX:t,rect:s})&&(l.bottom=!0),l}var y=Object.freeze({topLeft:"nw-resize",topRight:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",leftOrRight:"ew-resize",topOrBottom:"ns-resize"});function E(e,t){return e.left&&e.top?t.topLeft:e.right&&e.top?t.topRight:e.left&&e.bottom?t.bottomLeft:e.right&&e.bottom?t.bottomRight:e.left||e.right?t.leftOrRight:e.top||e.bottom?t.topOrBottom:""}function x(e){var t=e.edges,n=e.initialRectangle,r=e.newRectangle,i={};return Object.keys(t).forEach(function(e){i[e]=r[e]-n[e]}),i}var z="resize-active",R=function(){function e(e,r,i){this.renderer=e,this.elm=r,this.zone=i,this.resizeEdges={},this.enableGhostResize=!1,this.resizeSnapGrid={},this.resizeCursors=y,this.resizeCursorPrecision=3,this.ghostElementPositioning="fixed",this.resizeStart=new t.EventEmitter,this.resizing=new t.EventEmitter,this.resizeEnd=new t.EventEmitter,this.mouseup=new n.Subject,this.mousedown=new n.Subject,this.mousemove=new n.Subject,this.pointerEventListenerSubscriptions={},this.pointerEventListeners=w.getInstance(e,i)}return e.prototype.ngOnInit=function(){var e=this;this.pointerEventListenerSubscriptions.pointerDown=this.pointerEventListeners.pointerDown.subscribe(function(t){var n=t.clientX,r=t.clientY;e.mousedown.next({clientX:n,clientY:r})}),this.pointerEventListenerSubscriptions.pointerMove=this.pointerEventListeners.pointerMove.subscribe(function(t){var n=t.clientX,r=t.clientY,i=t.event;e.mousemove.next({clientX:n,clientY:r,event:i})}),this.pointerEventListenerSubscriptions.pointerUp=this.pointerEventListeners.pointerUp.subscribe(function(t){var n=t.clientX,r=t.clientY;e.mouseup.next({clientX:n,clientY:r})});var t,n=function(){t&&t.clonedNode&&(e.elm.nativeElement.parentElement.removeChild(t.clonedNode),e.renderer.setStyle(e.elm.nativeElement,"visibility","inherit"))},r=this.mousemove.pipe(h.share());r.pipe(u.filter(function(){return!!t})).subscribe(function(e){e.event.preventDefault()}),r.pipe(d.throttle(function(){return o.interval(50)})).subscribe(function(n){var r=b({clientX:n.clientX,clientY:n.clientY,elm:e.elm,allowedEdges:e.resizeEdges,cursorPrecision:e.resizeCursorPrecision}),i=Object.assign({},y,e.resizeCursors);if(t){var o=E(t.edges,i);e.renderer.setStyle(document.body,"cursor",o)}else{o=E(r,i);e.renderer.setStyle(e.elm.nativeElement,"cursor",o)}e.setElementClass(e.elm,z,!!t),e.setElementClass(e.elm,"resize-left-hover",!0===r.left),e.setElementClass(e.elm,"resize-right-hover",!0===r.right),e.setElementClass(e.elm,"resize-top-hover",!0===r.top),e.setElementClass(e.elm,"resize-bottom-hover",!0===r.bottom)});this.mousedown.pipe(l.mergeMap(function(n){function o(e){return{clientX:e.clientX-n.clientX,clientY:e.clientY-n.clientY}}var l=function(){var n={x:1,y:1};return t&&(e.resizeSnapGrid.left&&t.edges.left?n.x=+e.resizeSnapGrid.left:e.resizeSnapGrid.right&&t.edges.right&&(n.x=+e.resizeSnapGrid.right),e.resizeSnapGrid.top&&t.edges.top?n.y=+e.resizeSnapGrid.top:e.resizeSnapGrid.bottom&&t.edges.bottom&&(n.y=+e.resizeSnapGrid.bottom)),n};function d(e,t){return{x:Math.ceil(e.clientX/t.x),y:Math.ceil(e.clientY/t.y)}}return i.merge(r.pipe(p.take(1)).pipe(s.map(function(e){return[,e]})),r.pipe(a.pairwise())).pipe(s.map(function(e){var t=e[0],n=e[1];return[t?o(t):t,o(n)]})).pipe(u.filter(function(e){var t=e[0],n=e[1];if(!t)return!0;var r=l(),i=d(t,r),o=d(n,r);return i.x!==o.x||i.y!==o.y})).pipe(s.map(function(e){var t=e[1],n=l();return{clientX:Math.round(t.clientX/n.x)*n.x,clientY:Math.round(t.clientY/n.y)*n.y}})).pipe(c.takeUntil(i.merge(e.mouseup,e.mousedown)))})).pipe(u.filter(function(){return!!t})).pipe(s.map(function(e){var n=e.clientX,r=e.clientY;return v(t.startingRect,t.edges,n,r)})).pipe(u.filter(function(e){return!!(e.height&&e.width&&e.height>0&&e.width>0)})).pipe(u.filter(function(n){return!e.validateResize||e.validateResize({rectangle:n,edges:x({edges:t.edges,initialRectangle:t.startingRect,newRectangle:n})})})).subscribe(function(n){t&&t.clonedNode&&(e.renderer.setStyle(t.clonedNode,"height",n.height+"px"),e.renderer.setStyle(t.clonedNode,"width",n.width+"px"),e.renderer.setStyle(t.clonedNode,"top",n.top+"px"),e.renderer.setStyle(t.clonedNode,"left",n.left+"px")),e.zone.run(function(){e.resizing.emit({edges:x({edges:t.edges,initialRectangle:t.startingRect,newRectangle:n}),rectangle:n})}),t.currentRect=n}),this.mousedown.pipe(s.map(function(t){var n=t.clientX,r=t.clientY;return t.edges||b({clientX:n,clientY:r,elm:e.elm,allowedEdges:e.resizeEdges,cursorPrecision:e.resizeCursorPrecision})})).pipe(u.filter(function(e){return Object.keys(e).length>0})).subscribe(function(r){t&&n();var i=function(e,t){var n=0,r=0,i=e.nativeElement.style,o=["transform","-ms-transform","-moz-transform","-o-transform"].map(function(e){return i[e]}).find(function(e){return!!e});if(o&&o.includes("translate")&&(n=o.replace(/.*translate\((.*)px, (.*)px\).*/,"$1"),r=o.replace(/.*translate\((.*)px, (.*)px\).*/,"$2")),"absolute"===t)return{height:e.nativeElement.offsetHeight,width:e.nativeElement.offsetWidth,top:e.nativeElement.offsetTop-r,bottom:e.nativeElement.offsetHeight+e.nativeElement.offsetTop-r,left:e.nativeElement.offsetLeft-n,right:e.nativeElement.offsetWidth+e.nativeElement.offsetLeft-n};var s=e.nativeElement.getBoundingClientRect();return{height:s.height,width:s.width,top:s.top-r,bottom:s.bottom-r,left:s.left-n,right:s.right-n,scrollTop:e.nativeElement.scrollTop,scrollLeft:e.nativeElement.scrollLeft}}(e.elm,e.ghostElementPositioning);if(t={edges:r,startingRect:i,currentRect:i},e.enableGhostResize){t.clonedNode=e.elm.nativeElement.cloneNode(!0);var o=Object.assign({},y,e.resizeCursors);e.elm.nativeElement.parentElement.appendChild(t.clonedNode),e.renderer.setStyle(e.elm.nativeElement,"visibility","hidden"),e.renderer.setStyle(t.clonedNode,"position",e.ghostElementPositioning),e.renderer.setStyle(t.clonedNode,"left",t.startingRect.left+"px"),e.renderer.setStyle(t.clonedNode,"top",t.startingRect.top+"px"),e.renderer.setStyle(t.clonedNode,"height",t.startingRect.height+"px"),e.renderer.setStyle(t.clonedNode,"width",t.startingRect.width+"px"),e.renderer.setStyle(t.clonedNode,"cursor",E(t.edges,o)),e.renderer.addClass(t.clonedNode,"resize-ghost-element"),t.clonedNode.scrollTop=t.startingRect.scrollTop,t.clonedNode.scrollLeft=t.startingRect.scrollLeft}e.zone.run(function(){e.resizeStart.emit({edges:x({edges:r,initialRectangle:i,newRectangle:i}),rectangle:v(i,{},0,0)})})}),this.mouseup.subscribe(function(){t&&(e.renderer.removeClass(e.elm.nativeElement,z),e.renderer.setStyle(document.body,"cursor",""),e.renderer.setStyle(e.elm.nativeElement,"cursor",""),e.zone.run(function(){e.resizeEnd.emit({edges:x({edges:t.edges,initialRectangle:t.startingRect,newRectangle:t.currentRect}),rectangle:t.currentRect})}),n(),t=null)})},e.prototype.ngOnDestroy=function(){this.mousedown.complete(),this.mouseup.complete(),this.mousemove.complete(),this.pointerEventListenerSubscriptions.pointerDown.unsubscribe(),this.pointerEventListenerSubscriptions.pointerMove.unsubscribe(),this.pointerEventListenerSubscriptions.pointerUp.unsubscribe()},e.prototype.setElementClass=function(e,t,n){n?this.renderer.addClass(e.nativeElement,t):this.renderer.removeClass(e.nativeElement,t)},e}();R.decorators=[{type:t.Directive,args:[{selector:"[mwlResizable]"}]}],R.ctorParameters=function(){return[{type:t.Renderer2},{type:t.ElementRef},{type:t.NgZone}]},R.propDecorators={validateResize:[{type:t.Input}],resizeEdges:[{type:t.Input}],enableGhostResize:[{type:t.Input}],resizeSnapGrid:[{type:t.Input}],resizeCursors:[{type:t.Input}],resizeCursorPrecision:[{type:t.Input}],ghostElementPositioning:[{type:t.Input}],resizeStart:[{type:t.Output}],resizing:[{type:t.Output}],resizeEnd:[{type:t.Output}]};var w=function(){function e(e,t){this.pointerDown=new r.Observable(function(n){var r,i;return t.runOutsideAngular(function(){r=e.listen("document","mousedown",function(e){n.next({clientX:e.clientX,clientY:e.clientY,event:e})}),i=e.listen("document","touchstart",function(e){n.next({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY,event:e})})}),function(){r(),i()}}).pipe(h.share()),this.pointerMove=new r.Observable(function(n){var r,i;return t.runOutsideAngular(function(){r=e.listen("document","mousemove",function(e){n.next({clientX:e.clientX,clientY:e.clientY,event:e})}),i=e.listen("document","touchmove",function(e){n.next({clientX:e.targetTouches[0].clientX,clientY:e.targetTouches[0].clientY,event:e})})}),function(){r(),i()}}).pipe(h.share()),this.pointerUp=new r.Observable(function(n){var r,i,o;return t.runOutsideAngular(function(){r=e.listen("document","mouseup",function(e){n.next({clientX:e.clientX,clientY:e.clientY,event:e})}),i=e.listen("document","touchend",function(e){n.next({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY,event:e})}),o=e.listen("document","touchcancel",function(e){n.next({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY,event:e})})}),function(){r(),i(),o()}}).pipe(h.share())}return e.getInstance=function(t,n){return e.instance||(e.instance=new e(t,n)),e.instance},e}(),X=function(){function e(e,t,n,r){this.renderer=e,this.element=t,this.zone=n,this.resizable=r,this.resizeEdges={},this.eventListeners={}}return e.prototype.ngOnDestroy=function(){this.unsubscribeEventListeners()},e.prototype.onMousedown=function(e,t,n){var r=this;e.preventDefault(),this.zone.runOutsideAngular(function(){r.eventListeners.touchmove||(r.eventListeners.touchmove=r.renderer.listen(r.element.nativeElement,"touchmove",function(e){r.onMousemove(e,e.targetTouches[0].clientX,e.targetTouches[0].clientY)})),r.eventListeners.mousemove||(r.eventListeners.mousemove=r.renderer.listen(r.element.nativeElement,"mousemove",function(e){r.onMousemove(e,e.clientX,e.clientY)})),r.resizable.mousedown.next({clientX:t,clientY:n,edges:r.resizeEdges})})},e.prototype.onMouseup=function(e,t){var n=this;this.zone.runOutsideAngular(function(){n.unsubscribeEventListeners(),n.resizable.mouseup.next({clientX:e,clientY:t,edges:n.resizeEdges})})},e.prototype.onMousemove=function(e,t,n){this.resizable.mousemove.next({clientX:t,clientY:n,edges:this.resizeEdges,event:e})},e.prototype.unsubscribeEventListeners=function(){var e=this;Object.keys(this.eventListeners).forEach(function(t){e.eventListeners[t](),delete e.eventListeners[t]})},e}();X.decorators=[{type:t.Directive,args:[{selector:"[mwlResizeHandle]"}]}],X.ctorParameters=function(){return[{type:t.Renderer2},{type:t.ElementRef},{type:t.NgZone},{type:R}]},X.propDecorators={resizeEdges:[{type:t.Input}],onMousedown:[{type:t.HostListener,args:["touchstart",["$event","$event.touches[0].clientX","$event.touches[0].clientY"]]},{type:t.HostListener,args:["mousedown",["$event","$event.clientX","$event.clientY"]]}],onMouseup:[{type:t.HostListener,args:["touchend",["$event.changedTouches[0].clientX","$event.changedTouches[0].clientY"]]},{type:t.HostListener,args:["touchcancel",["$event.changedTouches[0].clientX","$event.changedTouches[0].clientY"]]},{type:t.HostListener,args:["mouseup",["$event.clientX","$event.clientY"]]}]};var Y=function(){return function(){}}();Y.decorators=[{type:t.NgModule,args:[{declarations:[R,X],exports:[R,X]}]}],Y.ctorParameters=function(){return[]},e.ResizableDirective=R,e.ResizeHandleDirective=X,e.ResizableModule=Y,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angular-resizable-element.umd.min.js.map
